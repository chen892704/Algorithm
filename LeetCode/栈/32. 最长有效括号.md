# 20. 有效的括号
> 来源：力扣（LeetCode）
链接：https://leetcode.cn/problems/longest-valid-parentheses/description

给你一个只包含 '(' 和 ')' 的字符串，找出最长有效（格式正确且连续）括号 子串 的长度。

左右括号匹配，即每个左括号都有对应的右括号将其闭合的字符串是格式正确的，比如 "(()())"。

## 解题思路
1. 使用栈统计字符串中匹配的括号，并在数组中标记其位置 `mark[i] = 1`
2. 遍历标记数组，找最长的连续匹配括号，即连续的 1 （因为连续的匹配括号具有传递性）


## 代码实现
时间复杂度 O(n)，空间复杂度 O(n)
```cpp
cclass Solution {
public:
    int longestValidParentheses(string s) {
        int n = s.length();
        stack<int> st;
        vector<int> mark(n, 0);
        for (int i=0; i<n; ++i) {
            char &c = s[i];
            // 左括号直接入栈
            if (c == '(') {
                st.push(i);
            }
            // 栈顶是左括号，匹配
            else if (!st.empty()) {
                int j = st.top();
                st.pop();
                mark[i] = mark[j] = 1; // 标记匹配的括号
            }
        }

        // 找到标记数组中最多连续的 1
        int res = 0, cur = 0;
        for (int i : mark) {
            if (i == 1) {
                ++cur;
            }
            else {
                res = max(res, cur);
                cur = 0;
            }
        }
        
        // 补充最后一次匹配
        return max(res, cur);
    }
};
```
