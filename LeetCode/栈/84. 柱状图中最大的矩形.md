# 84. 柱状图中最大的矩形
> 来源：力扣（LeetCode）
链接：https://leetcode.cn/problems/largest-rectangle-in-histogram/description

给定 n 个非负整数，用来表示柱状图中各个柱子的高度。每个柱子彼此相邻，且宽度为 1 。

求在该柱状图中，能够勾勒出来的矩形的最大面积。

## 解题思路
单调栈，思路如下：
0. 创建单调栈，从栈顶到栈底，栈中数据单调递增。栈中记录的，是未找到右边界（即右边第一个比它矮的）的柱子下标
1. 先给数组左右增加高度为 0 的哨兵，这样方便计算以每个柱子高度为高的最大矩形
2. 从左到右遍历数组，判断当前柱子是否比栈顶更低，是的话就找到右边界，出栈后的栈顶下标即为左边界（左边第一个比它矮的），计算矩形面积更新结果
3. 循环步骤 2，完成后输出结果

**特别注意：**
1. 增加哨兵位，这样左右都有边界，遍历完成后原始柱子都能枚举到，不用处理栈中遗留的数据
2. 计算矩形宽度时，需要先 pop 再计算宽度（i - st.top - 1），即以刚刚 pop 出柱子为高的情况下，左右第一个比它矮的为左右边界



## 代码实现
时间复杂度 O(n)，空间复杂度 O(n)
```cpp
class Solution {
public:
    int largestRectangleArea(vector<int>& heights) {
        // 前后增加哨兵位
        heights.insert(heights.begin(), 0);
        heights.push_back(0);

        stack<int> st;
        int ans = 0;
        for (int i=0; i< heights.size(); ++i) {
            // 找到第一个比栈顶矮的柱子 (比栈顶高说明，以该柱子为高，宽度还能往右扩展)
            while (!st.empty() && heights[i] < heights[st.top()]) {
                int h = heights[st.top()];
                st.pop();
                // 宽度 = [左边第一个比它矮的] 到 [右边第一个比它矮的]
                int w = i - st.top() - 1;
                ans = max(ans, h*w);
                
            }
            st.push(i);
        }
        return ans;
    }
};
```
